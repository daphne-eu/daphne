// Connected components.

// Arguments:
// - f ... filename of the adjacency matrix (provide as `--args f=\"foo.csv\"`)

// Read adjacency matrix.
G = readMatrix($f);

start=now();

// Initialization.
maxi = 100;
c = seq(1.0, as.f64(nrow(G)), 1.0); // init w/ vertex IDs
diff = inf;

// Iterative computation of connected components (decisive part).
for(iter in 1:maxi) {
    x = aggMax(G * t(c), 0);
    c = max(x, c);
}

end=now();
print((end-start) / 1000000000.0);
